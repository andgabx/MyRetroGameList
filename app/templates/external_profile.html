<!doctype html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<title>User Profile</title>

		{% load static %}

		<link rel="stylesheet" type="text/css" href="{% static 'styles/external_profile.css' %}" />
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
		<script src="https://cdn.tailwindcss.com"></script>
	</head>

	<body class="bg-neutral-950 bg-gradient min-h-screen">
		{% include "components/sidebar.html" %}

		<!-- Main -->
		<div id="mainContent" class="transition-all duration-300 p-4">
			<div class="mx-auto max-w-7xl">
				<!-- Row de perfil -->
				<div id="usercontent" class="grid md:grid-cols-3 gap-8 my-8">
					<!-- Primeira Coluna - Foto de Perfil -->
					<div class="flex justify-center">
						<img class="rounded-full w-100 h-100 object-cover" src="{% static 'media/assets/profileTemplate.png' %}" alt="Profile" />
					</div>

					<!-- Segunda Coluna - Informações -->
					<div class="block text-center md:text-center">
						<h1 class="text-3xl text-white my-4 font-bold">{{ profile.user.username }}</h1>

						<p class="text-white text-lg font-bold">Level 1</p>

						<div class="flex justify-center items-center mt-2">
							<p class="text-white mr-2">Recife, Brasil</p>
							<i class="bi bi-flag text-white text-2xl"></i>
						</div>

						<!-- Link para abrir o modal -->
						{% if user.is_authenticated and isProfileOwner %}
						<div class="mt-2">
							<a href="#" class="text-white hover:underline" id="editDescriptionBtn">Adicionar descrição do perfil</a>
						</div>
						{% endif %}

						<div class="mt-4 overflow-x-auto">
							<p class="text-white text-5xl max-w-40" id="userDescription">{{ profile.user_description }}</p>
						</div>
					</div>

					<!-- Terceira Coluna - Notificações -->
					<div class="space-y-4">
						<h1 class="text-white py-2 text-2xl text-center font-bold">Best Game Ever</h1>
						<img class="rounded-full w-100 h-100 object-cover" src="{% static 'media/assets/profileTemplate.png' %}" alt="Profile" />
					</div>

					<!--IMAGEM AQUI-->
				</div>

				<div class="space-y-8">{% include "components/profile_horizontal_list.html" with games=profile.favorite_list.all list_name="Favorites" %} {% include "components/profile_horizontal_list.html" with games=profile.playing_now.all list_name="Playing Now" %} {% include "components/profile_horizontal_list.html" with games=profile.to_play.all list_name="To play" %} {% include "components/profile_horizontal_list.html" with games=profile.already_played.all list_name="Already Played" %}</div>
			</div>
		</div>

		<!-- Footer -->
		{% include "components/footer.html" %}

		<!-- Formulário para editar a descrição -->
		{% if user.is_authenticated and isProfileOwner %}
		<div id="descriptionModal" class="fixed z-10 inset-0 overflow-y-auto">
			<div class="flex items-center justify-center min-h-screen px-4">
				<div class="bg-opacity-80 bg-purple-800 relative rounded-lg shadow-lg w-full max-w-md">
					<div class="p-4 border-b">
						<h2 class="text-xl text-center text-white font-bold">Editar Descrição</h2>
					</div>

					<!-- Formulário que envia a nova descrição -->
					<form method="POST" action="{% url 'edit_profile_description' profile.user.id %}">
						{% csrf_token %}
						<div class="p-4">
							<textarea name="description" id="descriptionInput" rows="4" class="w-full p-2 border rounded-md" placeholder="Escreva sua descrição aqui">{{ profile.user_description }}</textarea>
						</div>
						<div class="flex p-4 border-t mx-auto justify-evenly space-x-4">
							<button type="submit" class="text-center bg-green-600 hover:bg-green-700 text-white py-2 px-6 rounded-md shadow-lg transition duration-400 ease-in-out transform hover:scale-110">Salvar</button>
							<button type="button" id="cancelBtn" class="text-center bg-red-600 hover:bg-red-700 text-white py-2 px-6 rounded-md shadow-lg transition duration-400 ease-in-out transform hover:scale-110">Cancelar</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		{% endif %}

		<script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
		<script src="{% static 'page_scripts/external_profile.js' %}"></script>
	</body>
</html>
